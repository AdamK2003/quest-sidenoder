<script>
  console.log('ONLOAD installed');
  $('#updateBadge').hide();
  $('#listTable tbody').html('');
  ipcRenderer.send('get_installed', '');

  loadInclude('device_info.twig', 'device_infoDiv');
  // loadInclude('searchform.twig', 'searchformdiv');

  function getUpdates() {
    $('#updateBadge').html(`<i class="fa fa-refresh fa-spin"></i> Please wait`);

    $('#listTable tbody').html('');
    ipcRenderer.send(`get_installed_with_updates`, ``);
  }


  function update(elem) {
    //elem.parentElement.innerHTML = `<i class="fa fa-refresh fa-spin"></i> Please wait`;
    ipcRenderer.send('update', elem.dataset.path);
  }

  function uninstall(element, packageName) {
    $(element).children('span').innerHTML = `<i class="fa fa-refresh fa-spin"></i> Please wait`;
    element.parentElement.innerHTML = `<i class="fa fa-refresh fa-spin"></i> Please wait`;
    ipcRenderer.send('uninstall', packageName);
  }
  function startApp(element, packageName) {
    // $(element).children('span').innerHTML = `<i class="fa fa-refresh fa-spin"></i> Please wait`;
    // element.parentElement.innerHTML = `<i class="fa fa-refresh fa-spin"></i> Please wait`;
    ipcRenderer.send('get_activities', packageName);
  }

</script>

<div id="device_infoDiv"></div>


<div class="card text-white bg-primary">
  <div class="card-header">
    <h2 class="pull-left push-left" style="padding-top: 10px">Installed APP's</h2>
    <h2 class="pull-right push-right" id="updateheader">
      <script>
        if (remote.getGlobal('mounted')) {
          $('#updateheader').html(`<a onclick="getUpdates()"> <span id="updateBadge" class="btn btn-info btn-md"><i class="fa fa-search" aria-hidden="true"></i> Click to check mount for updates</span></a>`)
        }
        else {
          $('#updateheader').html(`<span id="updateBadge" class="btn btn-danger btn-md">Drive not mounted, cannot check for updates</span>`);
        }
      </script>
    </h2>
  </div>
  <div class="card-body">
    <div class="card-text">
      <div id="searchformdiv"></div>
      <br>
      <table class="table table-striped table-condensed text-white" id="listTable">
        <tbody>
        </tbody>
      </table>
    </div>
  </div>
</div>
